<!DOCTYPE html>
<html>
  <head>
    <title><%= content_for(:title) || t('home.title', default: "Fiver Clone") %></title>
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="mobile-web-app-capable" content="yes">
    <%= csrf_meta_tags %>
    <%= csp_meta_tag %>

    <%= yield :head %>

    <!-- PWA Manifest (if enabled) -->
    <%#= tag.link rel: "manifest", href: pwa_manifest_path(format: :json) %>

    <link rel="icon" href="/icon.png" type="image/png">
    <link rel="icon" href="/icon.svg" type="image/svg+xml">
    <link rel="apple-touch-icon" href="/icon.png">

    <!-- Stylesheets -->
    <%= stylesheet_link_tag :app, "data-turbo-track": "reload" %>
    
    <%= javascript_include_tag "application", "data-turbo-track": "reload" %>
    <%= javascript_importmap_tags %>  <!-- Ensure this is after the previous line -->
  </head>

  <body>
    <p class="notice"><%= notice %></p>
    <p class="alert"><%= alert %></p>

    <!-- Navigation Bar -->
    <nav>
      <% if user_signed_in? %>
        <% if current_user.seller_profile.present? %>
          <%= link_to "Account", account_seller_path(current_user.seller_profile) %>
        <% else %>
          <%= link_to "Create Seller Profile", new_seller_profile_path %>
        <% end %>
      <% else %>
        <%= link_to t('home.login'), new_user_session_path, class: 'btn btn-primary' %>
        <%= link_to t('home.sign_up'), new_user_registration_path, class: 'btn btn-success' %>
      <% end %>
    </nav>
    
    <!-- Language Selector -->
    <form action="<%= set_language_path %>" method="get">
      <select name="locale" onchange="this.form.submit();">
        <% { 'English' => 'en', 'French' => 'fr', 'Spanish' => 'es', 'German' => 'de' }.each do |name, code| %>
          <option value="<%= code %>" <%= 'selected' if I18n.locale.to_s == code %>>
            <%= name %>
          </option>
        <% end %>
      </select>
    </form>
    
    <!-- Main Content -->
    <div class="profile-info">
      <h2>Account Details</h2>
      <p><strong>Full Name:</strong> <%= @seller_profile.full_name %></p>
      <p><strong>Display Name:</strong> <%= @seller_profile.display_name %></p>
      <p><strong>Profile Description:</strong> <%= @seller_profile.description %></p>
      <p><strong>Preferred Language:</strong> <%= @seller_profile.language %></p>

      <!-- Profile Picture -->
      <% if @seller_profile.profile_picture.attached? %>
        <p><strong>Profile Picture:</strong> <%= image_tag @seller_profile.profile_picture %></p>
      <% else %>
        <p><strong>Profile Picture:</strong> No picture available</p>
      <% end %>

      <!-- Occupation -->
      <p><strong>Occupation:</strong> <%= @seller_profile.occupation || "No occupation specified" %></p>

      <!-- Skills -->
      <% if @seller_profile.skills.present? %>
        <p><strong>Skills:</strong></p>
        <ul>
          <% @seller_profile.skills.split(',').each do |skill| %>
            <li><%= skill.strip %></li>  <!-- .strip removes any leading/trailing spaces -->
          <% end %>
        </ul>
      <% else %>
        <p>No skills listed.</p>
      <% end %>

      <!-- Education -->
      <p><strong>Education:</strong> <%= @seller_profile.education || "No education listed" %></p>

      <!-- Certifications -->
      <p><strong>Certifications:</strong> <%= @seller_profile.certifications || "No certifications listed" %></p>

      <!-- Personal Website -->
      <% if @seller_profile.personal_website.present? %>
        <p><strong>Personal Website:</strong> <%= link_to @seller_profile.personal_website, @seller_profile.personal_website, target: "_blank" %></p>
      <% else %>
        <p><strong>Personal Website:</strong> Not provided</p>
      <% end %>
    </div>

    <%= link_to t('home.fiverb'), root_path, class: "btn btn-primary" %>
  </body>
</html>
